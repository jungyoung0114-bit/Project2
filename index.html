<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Morse code art with sounds</title>
<style>
body {
  font-family: Futura, "Trebuchet MS", Arial, sans-serif;
  background-color: #ffffff;
  color: #111111;
  text-align: center;
  padding-top: 50px;
  overflow-x: hidden;
  position: relative;
  transition: background-color 0.5s ease;
}
#title {
  font-size: 1.5em;
  font-weight: 600;
  margin-bottom: 10px;
  letter-spacing: 1px;
}
#subtitle {
  font-size: 1em;
  color: #555;
  margin-bottom: 30px;
}
#output {
  margin-top: 40px;
  position: relative;
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 20px;
}

.morse-group {
  display: inline-flex;
  flex-direction: column-reverse;
  align-items: center;
  gap: 8px;
  transition: transform 0.4s ease;
  position: relative;
  transform-origin: bottom center;
  transform: rotate(90deg);
}

.dot, .dash {
  display: inline-block;
  animation: wave 1.6s ease-in-out infinite;
}

.dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  animation-delay: calc(var(--i) * 0.05s);
}
.dash {
  width: 6px;
  height: 30px;
  border-radius: 3px;
  animation-delay: calc(var(--i) * 0.05s);
}

.dot.big { width: 18px; height: 18px; }
.dash.big { width: 10px; height: 45px; }

@keyframes wave {
  0%, 100% { transform: translateY(0); opacity: 1; }
  25% { transform: translateY(-6px); opacity: 0.9; }
  50% { transform: translateY(3px); opacity: 1; }
  75% { transform: translateY(-4px); opacity: 0.9; }
}

.fade-in { animation: fadeIn 0.5s ease forwards; }
@keyframes fadeIn { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }

.space { width: 30px; height: 1px; }

.ripple {
  position: absolute;
  border-radius: 50%;
  pointer-events: none;
}

.note {
  position: absolute;
  pointer-events: none;
  user-select: none;
}
</style>
</head>
<body>
<p id="title">Type letters to create <strong>Morse code art!</strong></p>
<p id="subtitle">Morse code acts as a bridge between written characters and audible signals.</p>
<div id="output"></div>

<script>
const outputEl = document.getElementById("output");

const morse = {
A:"Â·âˆ’",B:"âˆ’Â·Â·Â·",C:"âˆ’Â·âˆ’Â·",D:"âˆ’Â·Â·",E:"Â·",
F:"Â·Â·âˆ’Â·",G:"âˆ’âˆ’Â·",H:"Â·Â·Â·Â·",I:"Â·Â·",J:"Â·âˆ’âˆ’âˆ’",
K:"âˆ’Â·âˆ’",L:"Â·âˆ’Â·Â·",M:"âˆ’âˆ’",N:"âˆ’Â·",O:"âˆ’âˆ’âˆ’",
P:"Â·âˆ’âˆ’Â·",Q:"âˆ’âˆ’Â·âˆ’",R:"Â·âˆ’Â·",S:"Â·Â·Â·",T:"âˆ’",
U:"Â·Â·âˆ’",V:"Â·Â·Â·âˆ’",W:"Â·âˆ’âˆ’",X:"âˆ’Â·Â·âˆ’",Y:"âˆ’Â·âˆ’âˆ’",Z:"âˆ’âˆ’Â·Â·"
};

let lastGroup = null;

// ğŸ¹ Web Audio API
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

// ğŸ”¹ ìƒ‰ìƒ
const morseColors = ["#ef4444","#facc15","#22c55e","#3b82f6","#000000"];
const bgColors = ["#FFA500","#800080","#FF69B4","#A0522D","#ADFF2F","#87CEEB"]; // ì£¼í™©, ë³´ë¼, í•‘í¬, ê°ˆìƒ‰, ì—°ë‘, í•˜ëŠ˜

function randomColor(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

// ğŸ”¹ ëª¨ìŠ¤ì½”ë“œ ìƒì„±
function createMorse(letter,isUpper){
  const group = document.createElement("div");
  group.className = "morse-group fade-in";
  const code = morse[letter];
  const color = randomColor(morseColors);
  let i = 0;
  for(const symbol of code){
    const el = document.createElement("span");
    el.className = symbol==="Â·"
      ? (isUpper ? "dot big fade-in":"dot fade-in")
      : (isUpper ? "dash big fade-in":"dash fade-in");
    el.style.setProperty("--i", i++);
    el.style.backgroundColor = color;
    group.appendChild(el);
  }
  outputEl.appendChild(group);
  lastGroup = group;
}

function addSpace(){
  const space = document.createElement("div");
  space.className = "space";
  outputEl.appendChild(space);
  lastGroup = null;
}

// ğŸ”¹ í”¼ì•„ë…¸ ì†Œë¦¬ (ì•ŒíŒŒë²³)
function playPianoNote(){
  const osc = audioCtx.createOscillator();
  const gain = audioCtx.createGain();
  osc.type = 'sine';
  const freq = 261.63 * Math.pow(2, Math.floor(Math.random()*24)/12); // C4~C6
  osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
  gain.gain.setValueAtTime(0.15, audioCtx.currentTime);
  osc.connect(gain).connect(audioCtx.destination);
  osc.start();
  osc.stop(audioCtx.currentTime + 0.2);
}

// ğŸ”¹ ì¢…ì†Œë¦¬ (ìˆ«ì) - ìš¸ë¦¼ ì¶”ê°€
function playBellSound(){
  const baseFreq = 600 + Math.random()*200;
  const harmonics = [1, 1.5, 2, 2.5];
  harmonics.forEach((ratio, idx) => {
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    osc.type = 'sine';
    osc.frequency.setValueAtTime(baseFreq * ratio, audioCtx.currentTime);
    gain.gain.setValueAtTime(0.25 / (idx+1), audioCtx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 1.2);
    osc.connect(gain).connect(audioCtx.destination);
    osc.start();
    osc.stop(audioCtx.currentTime + 1.2);
  });
}

// ğŸ”¹ ì›í˜• íŒŒë™
function createRipple(x, y){
  const ripple = document.createElement("div");
  ripple.className = "ripple";
  const size = 10 + Math.random()*20;
  ripple.style.width = ripple.style.height = `${size}px`;
  ripple.style.left = `${x - size/2}px`;
  ripple.style.top = `${y - size/2}px`;
  ripple.style.border = `2px solid ${randomColor(morseColors)}`;
  const scale = 4 + Math.random()*3;
  const duration = 0.6 + Math.random()*0.6;
  ripple.style.transition = `transform ${duration}s ease-out, opacity ${duration}s ease-out`;
  ripple.style.transform = "scale(0)";
  ripple.style.opacity = "0.8";
  document.body.appendChild(ripple);
  requestAnimationFrame(()=>{
    ripple.style.transform = `scale(${scale})`;
    ripple.style.opacity = "0";
  });
  setTimeout(()=> ripple.remove(), duration*1000);
}

// ğŸ”¹ í•œê¸€í‚¤ ìŒí‘œ
function createNoteAtRandomPosition(){
  const note = document.createElement("div");
  note.textContent = "ğŸµ";
  note.className = "note";
  note.style.fontSize = `${20 + Math.random() * 20}px`;
  note.style.left = `${Math.random() * (window.innerWidth - 30)}px`;
  note.style.top = `${Math.random() * (window.innerHeight - 30)}px`;
  note.style.opacity = "1";
  note.style.transition = "transform 1s ease-out, opacity 1s ease-out";
  document.body.appendChild(note);
  requestAnimationFrame(()=>{
    note.style.transform = `translateY(-40px) scale(1.5)`;
    note.style.opacity = "0";
  });
  setTimeout(()=> note.remove(), 1000);
}

document.addEventListener("keydown",(event)=>{
  const key = event.key;
  const upper = key.toUpperCase();

  // ğŸ”¹ í•œê¸€ í‚¤ ê°ì§€
  if(/[ã„±-ã…|ã…-ã…£|ê°€-í£]/.test(key)){
    createNoteAtRandomPosition();
    return;
  }

  // ğŸ”¹ ì•ŒíŒŒë²³
  if(morse[upper]){
    const isUpper = /^[A-Z]$/.test(key) && key === upper;
    createMorse(upper,isUpper);
    playPianoNote();
    return;
  }

  // ğŸ”¹ Backspace
  if(key === "Backspace" && outputEl.lastChild){
    outputEl.removeChild(outputEl.lastChild);
    const children = Array.from(outputEl.children);
    lastGroup = children.length ? children[children.length-1] : null;
    if(lastGroup && lastGroup.classList.contains("space")) lastGroup = null;
    return;
  }

  // ğŸ”¹ Space
  if(key === " "){ addSpace(); return; }

  // ğŸ”¹ Shift ì œì™¸
  if(key === "Shift") return;

  // ğŸ”¹ ìˆ«ìí‚¤ â†’ ì¢…ì†Œë¦¬ + íŒŒë™
  if(/[0-9]/.test(key)){
    playBellSound();
    const x = Math.random() * window.innerWidth;
    const y = Math.random() * window.innerHeight;
    createRipple(x, y);
    return;
  }

  // ğŸ”¹ ê¸°íƒ€ í‚¤ â†’ ë°°ê²½ìƒ‰ ëœë¤
  document.body.style.backgroundColor = randomColor(bgColors);
});
</script>
</body>
</html>
